{\rtf1\ansi\ansicpg1252\cocoartf1265\cocoasubrtf190
{\fonttbl\f0\fnil\fcharset0 Verdana;}
{\colortbl;\red255\green255\blue255;\red76\green78\blue78;\red0\green0\blue0;\red0\green0\blue255;
\red64\green128\blue0;\red108\green5\blue211;\red0\green22\blue176;\red68\green21\blue176;}
\deftab480
\pard\pardeftab480\slleading20\pardirnatural

\f0\fs26 \cf2 --	Balthisar Tidy Screenshot Generation Suite\cf3 \
\cf2 --\cf3 \
\cf2 --	Created by: Jim Derry\cf3 \
\cf2 --	Created on: 04/12/14 13:41:11\cf3 \
\cf2 --\cf3 \
\cf2 --	Copyright \'a9 2014 Jim Derry\cf3 \
\cf2 --	All Rights Reserved\cf3 \
\cf2 --\cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	run\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  
\b \cf4 run
\b0 \cf3 \
	\cf2 -- configure these\cf3 \
	
\b set
\b0  \cf5 theApp\cf3  
\b to
\b0  "Balthisar Tidy"\
	
\b set
\b0  \cf5 theBasePath\cf3  
\b to
\b0  (\cf6 POSIX path\cf3  
\b of
\b0  (
\b \cf7 path to
\b0 \cf3  
\i \cf8 desktop
\i0 \cf3 ))\
	
\b set
\b0  \cf5 theDocFileName\cf3  
\b to
\b0  \cf5 theBasePath\cf3  & "document window.png"\
	
\b set
\b0  \cf5 thePrefsFilePrefix\cf3  
\b to
\b0  \cf5 theBasePath\cf3  & "tidy-prefs-0"\
	
\b set
\b0  \cf5 thePrefsFileSuffixNoSparkle\cf3  
\b to
\b0  "-nosparkle"\
	
\b set
\b0  \cf5 imageoptions\cf3  
\b to
\b0  \{\cf5 omitshadow\cf3 :
\i \cf6 true
\i0 \cf3 , \cf5 imagetype\cf3 :"png"\}\
	\cf2 -- end user configuration\cf3 \
	\
	\cf2 -----------------------------\cf3 \
	\cf2 -- Document Window\cf3 \
	\cf2 -----------------------------\cf3 \
	
\b set
\b0  \cf5 thePath\cf3  
\b to
\b0  \cf5 theDocFileName\cf3 \
	\
	
\b set
\b0  \cf5 the_window_id\cf3  
\b to
\b0  \cf5 set_application_window_size\cf3 (\cf5 theApp\cf3 , 1280, 800)\
	\
	\cf5 take_screenshot_window\cf3 (\cf5 the_window_id\cf3 , \cf5 thePath\cf3 , \cf5 imageoptions\cf3 )\
	\
	\cf2 -----------------------------\cf3 \
	\cf2 -- Preferences\cf3 \
	\cf2 -----------------------------\cf3 \
	\cf5 do_menu\cf3 (\cf5 theApp\cf3 , 2, "Preferences\'85")\
	
\b \cf4 delay
\b0 \cf3  3\
	\
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  \cf5 theApp\cf3 \
		
\b set
\b0  \cf5 the_window_id\cf3  
\b to
\b0  \cf6 id\cf3  
\b of
\b0  (
\i \cf4 window
\i0 \cf3  
\i \cf6 named
\i0 \cf3  "Balthisar Tidy Preferences")\
	
\b end
\b0  
\b tell
\b0 \
	\
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "System Events"\
		
\b tell
\b0  
\i \cf4 process
\i0 \cf3  \cf5 theApp\cf3 \
			
\b tell
\b0  
\i \cf4 window
\i0 \cf3  
\i \cf6 named
\i0 \cf3  "Balthisar Tidy Preferences"\
				\
				
\b tell
\b0  
\i \cf4 tab group
\i0 \cf3  1\
					\
					
\b repeat
\b0  
\b with
\b0  \cf5 i\cf3  
\b from
\b0  1 
\b to
\b0  
\b \cf4 count
\b0 \cf3  (
\i \cf4 radio buttons
\i0 \cf3 )\
						\
						
\b set
\b0  \cf5 thePath\cf3  
\b to
\b0  (\cf5 thePrefsFilePrefix\cf3  & (\cf5 i\cf3  
\b as
\b0  
\i \cf4 text
\i0 \cf3 ))\
						\
						
\b if
\b0  ((
\b \cf4 count
\b0 \cf3  
\b of
\b0  
\i \cf4 radio buttons
\i0 \cf3 ) = 3) 
\b then
\b0 \
							
\b set
\b0  \cf5 thePath\cf3  
\b to
\b0  \cf5 thePath\cf3  & \cf5 thePrefsFileSuffixNoSparkle\cf3 \
						
\b end
\b0  
\b if
\b0 \
						\
						
\b set
\b0  \cf5 thePath\cf3  
\b to
\b0  \cf5 thePath\cf3  & "." & (\cf5 imagetype\cf3  
\b of
\b0  \cf5 imageoptions\cf3 )\
						\
						
\b tell
\b0  
\i \cf4 radio button
\i0 \cf3  \cf5 i\cf3  
\b to
\b0  
\b \cf4 click
\b0 \cf3 \
						\
						
\b tell
\b0  
\b me
\b0  
\b to
\b0  \cf5 take_screenshot_window\cf3 (\cf5 the_window_id\cf3 , \cf5 thePath\cf3 , \cf5 imageoptions\cf3 )\
						
\b \cf4 delay
\b0 \cf3  1\
						\
					
\b end
\b0  
\b repeat
\b0 \
					\
					\
					\cf2 --set myButtons to (radio buttons)\cf3 \
					\cf2 --repeat with myButton in myButtons\cf3 \
					\cf2 --	tell myButton to click\cf3 \
					\cf2 --	set thePath to ((POSIX path of (path to desktop)) & thePrefsFilePrefix)\cf3 \
					\cf2 --	\cf3 \
					\cf2 --	delay 1\cf3 \
					\cf2 --end repeat\cf3 \
				
\b end
\b0  
\b tell
\b0 \
			
\b end
\b0  
\b tell
\b0 \
		
\b end
\b0  
\b tell
\b0 \
	
\b end
\b0  
\b tell
\b0 \
	\

\b end
\b0  
\b \cf4 run
\b0 \cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	set_application_window_size\cf3 \
\cf2 --		Sets an app's document window to the specified\cf3 \
\cf2 --		width and height\cf3 \
\cf2 -- @returns windowId as text\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  \cf5 set_application_window_size\cf3 (\cf5 theApp\cf3 , \cf5 winWidth\cf3 , \cf5 winHeight\cf3 )\
	
\b local
\b0  \cf5 screenWidth\cf3 , \cf5 screenHeight\cf3 , \cf5 yAxis\cf3 , \cf5 xAxis\cf3 \
	\
	
\b set
\b0  \cf5 screenWidth\cf3  
\b to
\b0  
\i \cf4 item
\i0 \cf3  3 
\b of
\b0  \cf5 screen_bounds\cf3 ()\
	
\b set
\b0  \cf5 screenHeight\cf3  
\b to
\b0  
\i \cf4 item
\i0 \cf3  4 
\b of
\b0  \cf5 screen_bounds\cf3 ()\
	
\b set
\b0  \cf5 yAxis\cf3  
\b to
\b0  (\cf5 screenHeight\cf3  - \cf5 winHeight\cf3 ) / 2 
\b as
\b0  
\i \cf4 integer
\i0 \cf3 \
	
\b set
\b0  \cf5 xAxis\cf3  
\b to
\b0  (\cf5 screenWidth\cf3  - \cf5 winWidth\cf3 ) / 2 
\b as
\b0  
\i \cf4 integer
\i0 \cf3 \
	\
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  \cf5 theApp\cf3 \
		
\b \cf4 activate
\b0 \cf3 \
		
\b \cf4 reopen
\b0 \cf3 \
		
\b set
\b0  
\b the
\b0  \cf6 bounds\cf3  
\b of
\b0  
\b the
\b0  
\b first
\b0  
\i \cf4 window
\i0 \cf3  
\b to
\b0  \{\cf5 xAxis\cf3 , \cf5 yAxis\cf3 , \cf5 winWidth\cf3  + \cf5 xAxis\cf3 , \cf5 winHeight\cf3  + \cf5 yAxis\cf3 \}\
		
\b return
\b0  \cf6 id\cf3  
\b of
\b0  
\i \cf4 window
\i0 \cf3  1\
	
\b end
\b0  
\b tell
\b0 \

\b end
\b0  \cf5 set_application_window_size\cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	take_screenshot_window\cf3 \
\cf2 -- 		Saves an app's window to a Posix path. The\cf3 \
\cf2 --		options is a record:\cf3 \
\cf2 --			imagetype: string png, jpg, etc.\cf3 \
\cf2 --			omitshadow: boolean\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  \cf5 take_screenshot_window\cf3 (\cf5 the_window_id\cf3 , \cf5 a_file_path\cf3 , \cf5 options\cf3 )\
	
\b local
\b0  \cf5 shell_command\cf3 \
	\
	
\b set
\b0  \cf5 shell_command\cf3  
\b to
\b0  "screencapture -l" & \cf5 the_window_id\cf3 \
	\
	
\b if
\b0  (\cf5 omitshadow\cf3  
\b of
\b0  (\cf5 options\cf3  & \{\cf5 omitshadow\cf3 :
\i \cf6 true
\i0 \cf3 \})) 
\b then
\b0 \
		
\b set
\b0  \cf5 shell_command\cf3  
\b to
\b0  \cf5 shell_command\cf3  & " -o"\
	
\b end
\b0  
\b if
\b0 \
	\
	
\b set
\b0  \cf5 shell_command\cf3  
\b to
\b0  \cf5 shell_command\cf3  & " -t" & \cf5 imagetype\cf3  
\b of
\b0  (\cf5 options\cf3  & \{\cf5 imagetype\cf3 :"png"\})\
	\
	
\b set
\b0  \cf5 shell_command\cf3  
\b to
\b0  \cf5 shell_command\cf3  & " " & (\cf6 quoted form\cf3  
\b of
\b0  \cf5 a_file_path\cf3 )\
	\
	
\b \cf7 do shell script
\b0 \cf3  \cf5 shell_command\cf3 \
	\

\b end
\b0  \cf5 take_screenshot_window\cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	screen_bounds\cf3 \
\cf2 --		Convenience to fetch the main screen dimensions.\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  \cf5 screen_bounds\cf3 ()\
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "Finder"\
		
\b return
\b0  \cf6 bounds\cf3  
\b of
\b0  
\i \cf4 window
\i0 \cf3  
\b of
\b0  \cf6 desktop\cf3 \
	
\b end
\b0  
\b tell
\b0 \

\b end
\b0  \cf5 screen_bounds\cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	do_menu\cf3 \
\cf2 --		Convenience to activate menu items via GUI Scripting\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  \cf5 do_menu\cf3 (\cf5 app_name\cf3 , \cf5 menu_name\cf3 , \cf5 menu_item\cf3 )\
	
\b try
\b0 \
		\cf2 -- bring the target application to the front\cf3 \
		
\b tell
\b0  
\i \cf4 application
\i0 \cf3  \cf5 app_name\cf3 \
			
\b \cf4 activate
\b0 \cf3 \
		
\b end
\b0  
\b tell
\b0 \
		
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "System Events"\
			
\b tell
\b0  
\i \cf4 process
\i0 \cf3  \cf5 app_name\cf3 \
				
\b tell
\b0  
\i \cf4 menu bar
\i0 \cf3  1\
					
\b tell
\b0  
\i \cf4 menu bar item
\i0 \cf3  \cf5 menu_name\cf3 \
						
\b tell
\b0  
\i \cf4 menu
\i0 \cf3  1\
							
\b \cf4 click
\b0 \cf3  
\i \cf4 menu item
\i0 \cf3  \cf5 menu_item\cf3 \
						
\b end
\b0  
\b tell
\b0 \
					
\b end
\b0  
\b tell
\b0 \
				
\b end
\b0  
\b tell
\b0 \
			
\b end
\b0  
\b tell
\b0 \
		
\b end
\b0  
\b tell
\b0 \
		
\b return
\b0  
\i \cf6 true
\i0 \cf3 \
	
\b on
\b0  
\b error
\b0  \cf5 error_message\cf3 \
		
\b return
\b0  
\i \cf6 false
\i0 \cf3 \
	
\b end
\b0  
\b try
\b0 \

\b end
\b0  \cf5 do_menu\cf3 \
}